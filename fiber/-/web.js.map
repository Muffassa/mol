{"version":3,"sources":["../../mol.jam.js","-","mol.ts","../../func/name/name.ts","../../object2/object2.ts","../fiber.ts"],"names":[],"mappings":"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","file":"web.js","sourcesContent":[null,null,"declare namespace $ {}\nexport = $\n\n","namespace $ {\n\t\n\texport var $mol_func_name_dict = new WeakMap< Function , string >()\n\n\texport function $mol_func_name( func : Function ) : string {\n\t\tlet name = $mol_func_name_dict.get( func )\n\t\tif( name != null ) return name\n\t\tname = func.name || Function.prototype.toString.call( func ).match( /([a-z0-9_$]*) ?(\\(|\\{|extends)/ )[ 1 ]\n\t\t$mol_func_name_dict.set( func , name )\n\t\t\n\t\treturn name\n\t}\n\n}\n","namespace $ {\n\n\texport namespace $$ { let $ }\n\t\n\texport class $mol_object2 {\n\t\t\n\t\tstatic $ = $ as ( typeof $ ) & Window\n\t\t$ = this.constructor['$'] as typeof $mol_object2.$\n\n\t\tpublic static make< Instance >( this : { new() : Instance } , config : Partial< Instance > ) : Instance {\n\t\t\tconst instance = new this\n\t\t\tfor( let key in config ) instance[ key ] = config[ key ]\n\t\t\treturn instance\n\t\t}\n\t\t\n\t\tstatic toString() : string {\n\t\t\treturn $mol_func_name( this )\n\t\t}\n\t\t\n\t\tdestructor() { }\n\t\t\n\t}\n\t\n}\n","namespace $ {\n\n\texport let $mol_fiber_stack = [] as $mol_fiber[]\n\n\texport function $mol_fiber_make< Result = void >( handler : ()=> Result , abort? : void | ( ()=> void ) ) {\n\t\tif( $mol_fiber.current ) $mol_fiber.current.step()\n\t\tlet master = $mol_fiber.current && $mol_fiber.current.master as $mol_fiber< Result >\n\t\tif( master ) return master \n\t\t\n\t\treturn new $mol_fiber< Result >( $mol_fiber.current , handler , abort )\n\t}\n\t\n\texport function $mol_fiber_start< Result = void >( handler : ()=> Result ) {\n\t\treturn $mol_fiber_make( handler ).start()\n\t}\n\n\texport function $mol_fiber_defer< Result = void >( handler : ()=> Result ) {\n\t\tconst defer = $mol_fiber.$.requestAnimationFrame || $mol_fiber.$.setTimeout\n\t\tdefer( $mol_fiber_func( handler ) )\n\t}\n\n\texport function $mol_fiber_func< Handler extends ( ... args : any[] )=> Result , Result = void >( handler : Handler ) {\n\t\treturn function $mol_fiber_func_wrapper( ... args : any[] ) {\n\t\t\treturn $mol_fiber_make( handler.bind( this , ... args ) as ()=> Result ).start()\n\t\t} as Handler\n\t}\n\n\texport function $mol_fiber_method< Host , Result >(\n\t\tobj : Host ,\n\t\tname : string ,\n\t\tdescr : TypedPropertyDescriptor< ( ... args : any[] )=> Result >\n\t) {\n\t\tdescr.value = $mol_fiber_func( descr.value )\n\t}\n\n\texport function $mol_fiber_sync< Result = void >(\n\t\trequest : ()=> PromiseLike< Result >\n\t) : Result {\n\n\t\tconst fiber = $mol_fiber_make< Result >( ()=> {\n\t\t\tthrow request().then(\n\t\t\t\tres => { fiber.done( res ) } ,\n\t\t\t\terror => { fiber.fail( error ) } ,\n\t\t\t)\n\t\t} )\n\n\t\treturn fiber.start()\n\n\t}\n\n\texport function $mol_fiber_async< Result = void >(\n\t\trequest : (\n\t\t\tback : (\n\t\t\t\tresponse :  ( ... args : any[] )=> Result\n\t\t\t)=> ( ... args : any[] )=> void\n\t\t)=> { (): any } | void\n\t) : Result {\n\n\t\tconst fiber = $mol_fiber_make< Result >( ()=> {\n\t\t\t\n\t\t\tconst promise = new Promise( ( done , fail )=> {\n\n\t\t\t\tfiber.abort = request( response => ( ... args : any[] )=> {\n\t\t\t\n\t\t\t\t\tif( !fiber.masters ) return\n\t\t\n\t\t\t\t\tnew Promise( ()=> {\n\t\t\t\t\t\tfiber.done( response( ... args ) )\n\t\t\t\t\t} ).catch( error => {\n\t\t\t\t\t\tfiber.fail( error )\n\t\t\t\t\t} )\n\n\t\t\t\t\tif( fiber.slave ) fiber.slave.start()\n\t\t\n\t\t\t\t} )\n\n\t\t\t} )\n\n\t\t\tthrow promise\n\n\t\t} )\n\n\t\treturn fiber.start()\n\n\t}\n\n\texport function $mol_fiber_warp() {\n\t\twhile( $mol_fiber.queue.length ) $mol_fiber.tick()\n\t}\n\n\texport function $mol_fiber_catch( catcher : ( error : Error )=> any ) {\n\t\t$mol_fiber.current.catcher = catcher\n\t}\n\n\texport class $mol_fiber< Result = any > extends $mol_object2 {\n\n\t\tstatic $ : typeof $mol_object2.$ & { Promise : PromiseConstructor }\n\t\t$ : typeof $mol_object2.$ & { Promise : PromiseConstructor }\n\n\t\tstatic quant = 8\n\n\t\tstatic current : $mol_fiber\n\t\t\n\t\tstatic scheduled = 0\n\t\tstatic deadline = Date.now() + $mol_fiber.quant\n\n\t\tcatcher : ( error : Error )=> any\n\n\t\tstatic tick() {\n\n\t\t\tconst now = Date.now()\n\t\t\tlet elapsed = Math.max( 0 , now - $mol_fiber.deadline )\n\t\t\t$mol_fiber.deadline = now + $mol_fiber.quant + Math.min( elapsed , 1000 ) / 10\n\t\n\t\t\tif( $mol_fiber.queue.length == 0 ) return\n\n\t\t\t$mol_fiber.schedule()\n\n\t\t\twhile( true ) {\n\t\t\t\tconst resolve = $mol_fiber.queue.shift()\n\t\t\t\tif( resolve ) resolve()\n\t\t\t\telse break\n\t\t\t}\n\t\t}\n\n\t\tstatic schedule() {\n\t\t\tif( $mol_fiber.scheduled ) return\n\n\t\t\tconst schedule = this.$.requestAnimationFrame || this.$.setTimeout\n\n\t\t\t$mol_fiber.scheduled = schedule( ()=> {\n\t\t\t\t$mol_fiber.scheduled = 0\n\t\t\t\t$mol_fiber.tick()\n\t\t\t} )\n\t\t}\n\n\t\tstatic queue = [] as ( ()=> void )[]\n\n\t\tconstructor(\n\t\t\tpublic slave : $mol_fiber ,\n\t\t\tpublic handler : ()=> Result ,\n\t\t\tpublic abort? : void | ( ()=> void ) ,\n\t\t) {\n\t\t\tsuper()\n\n\t\t\tif( slave ) {\n\t\t\t\tslave.master = this\n\t\t\t\tthis.$ = slave.$\n\t\t\t}\n\t\t}\n\n\t\tdestructor() {\n\t\t\tif( !this.masters ) return\n\n\t\t\tfor( let master of this.masters ) master.destructor()\t\t\t\n\t\t\tthis.masters = null\n\n\t\t\tif( this.abort ) this.abort()\n\t\t}\n\n\t\tmasters = [] as $mol_fiber[]\n\t\tcursor = -1\n\n\t\terror : Error = undefined\n\t\tresult : Result = undefined\n\n\t\tprotected _done : ( result : Result )=> void\n\n\t\tdone( result : Result ) {\n\t\t\tif( !this.masters ) return\n\n\t\t\tthis.result = result\n\t\t\tthis.abort = null\n\t\t\tthis.destructor()\n\t\t\t\n\t\t\treturn result\n\t\t}\n\n\t\tstatic catched = new WeakSet\n\n\t\tfail( error : Error | Promise<Result> ) : Error | Promise<Result> {\n\t\t\tif( !this.masters ) return\n\t\t\t\n\t\t\tif( error instanceof Promise ) {\n\t\t\t\tconst self = this\n\t\t\t\tconst listener = function $mol_fiber_listener() {\n\t\t\t\t\treturn self.start()\n\t\t\t\t}\n\t\t\t\treturn error.then( listener , listener )\n\t\t\t} else {\n\t\t\t\tif( !$mol_fiber.catched.has( error ) ) {\n\t\t\t\t\tif( error.stack ) error.stack = error.stack.replace( /.*\\$mol_fiber.*[\\n\\r]*/g , '' )\n\t\t\t\t\tconsole.error( error )\n\t\t\t\t\t$mol_fiber.catched.add( error )\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif( this.catcher ) {\n\t\t\t\tconst value = this.catcher( error )\n\t\t\t\tif(!( value instanceof Error )) {\n\t\t\t\t\tthis.done( value )\n\t\t\t\t\treturn error\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.error = error\n\t\t\tthis.abort = null\n\t\t\tthis.destructor()\n\t\t\t\n\t\t\treturn error\n\t\t}\n\n\t\tschedule() {\n\t\t\treturn new Promise( done => {\n\t\t\t\t$mol_fiber.queue.push( done )\n\t\t\t\t$mol_fiber.schedule()\n\t\t\t} )\n\t\t}\n\n\t\tlimit() {\n\t\t\tconst now = Date.now()\n\t\t\tif( now <= $mol_fiber.deadline ) return\n\n\t\t\tif( !$mol_fiber.current && $mol_fiber.queue.length === 0 ) {\n\t\t\t\t$mol_fiber.deadline = now + $mol_fiber.quant\n\t\t\t\treturn\n\t\t\t}\n\n\t\t\tthrow this.schedule()\n\t\t}\n\n\t\tstart() {\n\n\t\t\tif( this.masters ) {\n\t\n\t\t\t\tif( $mol_fiber.current ) {\n\t\t\t\t\tthis.execute()\n\t\t\t\t} else {\n\n\t\t\t\t\tconst self = this\n\t\t\t\t\tnew Promise( function $mol_fiber_catcher() {\n\t\t\t\t\t\tself.execute()\n\t\t\t\t\t} ).catch( error => {\n\n\t\t\t\t\t\tlet fiber = this as $mol_fiber\n\t\t\t\t\t\twhile( fiber.masters && fiber.master && fiber.master.masters ) fiber = fiber.master\n\n\t\t\t\t\t\twhile( fiber ) {\n\t\t\t\t\t\t\terror = fiber.fail( error )\n\n\t\t\t\t\t\t\tif( error instanceof Promise ) return\n\n\t\t\t\t\t\t\tif( error instanceof Error ) {\n\t\t\t\t\t\t\t\tfiber = fiber.slave\n\t\t\t\t\t\t\t\tcontinue\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tif( fiber.slave ) fiber.slave.start()\n\t\t\t\t\t\t\t\tbreak\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t} )\n\t\t\t\t\t\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif( this.error ) throw this.error\n\t\t\treturn this.result\n\n\t\t}\n\n\t\texecute() {\n\n\t\t\tconst slave = $mol_fiber.current\n\t\t\t\n\t\t\tthis.limit()\n\n\t\t\tthis.cursor = -1\n\t\t\t\n\t\t\ttry {\n\t\t\t\t$mol_fiber.current = this\n\t\t\t\tvar res = this.handler()\n\t\t\t\tthis.done( res )\n\t\t\t\tif( !slave && this.slave ) this.schedule().then( this.slave.start() )\n\t\t\t} finally {\n\t\t\t\t$mol_fiber.current = slave\n\t\t\t}\n\n\t\t\treturn res\n\t\t}\n\n\t\tstep() {\n\t\t\t++ this.cursor\n\t\t}\n\n\t\tget master() {\n\t\t\treturn this.masters[ this.cursor ]\n\t\t}\n\t\tset master( next : $mol_fiber ) {\n\t\t\tthis.masters[ this.cursor ] = next\n\t\t}\n\n\t\ttoString() {\n\t\t\tif( !this.slave ) return ''\n\t\t\treturn this.slave + '/' + this.slave.masters.indexOf( this )\n\t\t}\n\n\t}\n\n}\n"]}